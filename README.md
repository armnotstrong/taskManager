# Task Manager

## Brief 

This is a system:

* execute command using the http web ui

## how to run

* just clone this project.
* change dir to the project root.
* go run server.go
* visit http://localhost:8085 and check it out.

------

## Dirs

    +.
    ├── config
    │   └── task.json
    ├── download
    ├── README.md
    ├── resource
    │   ├── ksider.keystore
    │   └── sign.sh
    ├── server.go
    ├── static
    │   ├── css
    │   │   ├── bootstrap.min.css
    │   │   └── fileinput.css
    │   ├── fonts
    │   │   └── glyphicons-halflings-regular.woff
    │   ├── img
    │   │   └── loading.gif
    │   └── js
    │       ├── bootstrap.min.js
    │       ├── fileinput.js
    │       └── jquery-1.10.2.js
    ├── template
    │   ├── index.tmpl
    │   └── process.tmpl
    └── upload  

------

## content of the dirs

   * **config**:
      - stored task.json which defined the task using json
   * **download**:
      - place to store the files for user to download
   * **resource**:
      - place for programmers to store the script of config stuff needed by task
   * **upload**
      - user upload files will be stored here
   * server.go:
      - the main server programme
   * static:
      - mostly some js/css pulgins
   * template:
      - the templates for web server

------

## CONFIG:

  - `config/task.json` used for config task, only configed task could be saw and ran
  - a sample of `config/task.json`:

```javascript
{
    "findJob":{
        "ShortDesc":"find files in /tmp/", // short description of the task
        "Desc": "this is a sample of finding files under the /tmp/ dir", // more specificly description of the task
        "Cmd": "find", // system command or script or executable programme the task should run
        "Args": ["/tmp/"], // args list, could using the placeHolder of `$UPLOADFILE$` or `$$Args$$` which will be speicifeid by next chapter.
        "progressMark":["google","unix","Job","One"], // progress bar marks generated by programme to Stdout.
        "UploadFileNeeded":false, // will this programme need a uploaded files?
        "InputArgsNeeded":false //indicate whether user input args are needed.
    },
    "ls":{
        "ShortDesc":"list files the use specified",
        "Desc": "this is a sample of list files in the $dir user specified",
        "Cmd": "ls",
        "Args": ["$$dir$$","$$additionOption$$"],
        "progressMark":["google","unix","Job","One"],
        "UploadFileNeeded":false,
        "InputArgsNeeded":true,
        "InputArgsDesc":[
            {"dir":"which dir to list"},
            {"additionOption":"some args like -al"}
        ] 
    },
    "cat":{
        "ShortDesc":"cat file",
        "Desc": "just cat the file uploaded",
        "Cmd": "./resource/myCat.sh",
        "Args": ["$UPLOADFILE$"],
        "progressMark":[""],
        "UploadFileNeeded":true
    },
    "appendDate":{
        "ShortDesc":"appendDate to txt file",
        "Desc":"this is a sample of modify file uploaded and prepare for user to download",
        "Cmd": "./resource/appendDate.sh",
        "Args": ["$UPLOADFILE$","$UPLOADFILE$.modified"],
        "progressMark":[""],
        "UploadFileNeeded":true
    }

}
```
------

## NOTICE:

* User upload file will be stored in `upload` dir.
* Files to be download and generated by the **Task Program** should be in the `download` dir, if you wan't the use to see and download.
* File which user uploaded could be referred by `task.json` Using the PlaceHolder of `$UPLOADFILE$` but be sure that the **Task Program** using specificly the right relative path to using the uploaded file.
* if you want to use user input args, you should using the PlaceHolder `$$args$$` as args and define a map to descripe the args you wan't the user to input.
* uploaded file is limited to just one per task now.
* user input args could be multi.
* PlaceHolder `$UPLOADFILE$` could be a replacer in the arg list.
   if a script is `modify_upload_file.sh` and user upload a file `a.txt` after invoke the script

```bash
   ./modify_upload_file.sh a.txt a.txt.modified 

```
there will be a file named `a.txt.modified` under `download/`
then `Args` in `task.json` could be write like:
```
   ...

   "Cmd":"./resouce/modify_upload_file.sh",
   "UploadFileNeeded":true,
   "Args": ["$UPLOADFILE$","$UPLOADFILE$.modified"],
   
   ...
```

------
some samples are given in the `task.json`

------
concurrently excuting of same task is not supported by now.
